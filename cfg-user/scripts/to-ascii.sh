#! /bin/sh

if [ ${#} -ne 1 ]
then
  echo "usage: ${0##*/} FILE|DIR"
  echo
  echo "This is the desired behaviour:"
  echo "# mv -i -v łóżźć lozzc"
  echo "# mv -i -v ółź/łóżźć ółź/lozzc (only last FILE/DIR is normalized)"
  echo
  exit 1
fi

LIST='
& and
ӕ ae
æ ae
ǽ ae
ǣ ae
Ӕ AE
Æ AE
Ǽ AE
Ǣ AE
Ы bl
ы bl
Œ CE
ǳ dz
ǆ dz
ǲ Dz
ǅ Dz
Ǳ DZ
Ǆ DZ
ĳ ij
Ĳ IJ
ю io
Ю IO
ǉ lj
ǈ Lj
Ǉ LJ
ǌ nj
ǋ Nj
Ǌ NJ
œ oe
œ oe
Œ OE
ß SS
þ th
Þ TH
© (c)
® (R)
™ (TM)
½ 1-2
¼ 1-4
¾ 3-4
¹ 1
² 2
³ 3
¯ -
– -
— -
‒ -
· .
ά a
α a
а a
ӑ a
ӓ a
ª a
á a
à a
ă a
â a
ǎ a
å a
ǻ a
ä a
ǟ a
ã a
ȧ a
ǡ a
ą a
ā a
ȁ a
ȃ a
Ά A
Α A
Λ A
А A
Ѧ A
ѧ A
Ӑ A
Ӓ A
Á A
À A
Ă A
Â A
Ǎ A
Å A
Ǻ A
Ä A
Ǟ A
Ã A
Ȧ A
Ǡ A
Ą A
Ā A
Ȁ A
Ȃ A
Ⱥ A
Ʌ A
Б b
Ъ b
Ь b
ъ b
ь b
Ѣ b
ѣ b
ҍ b
ƀ b
Ƃ b
ƅ b
Ƅ b
Ƀ B
Β B
β B
ϐ B
В B
в B
Ҍ B
Ɓ B
ƃ B
¢ c
ς c
ϛ c
ϲ c
с c
ҁ c
ҫ c
ć c
ĉ c
č c
ċ c
ç c
ȼ c
ƈ c
Ƈ c
Ɔ c
ͻ C
ͼ C
ͽ C
Ϛ C
Ϲ C
Ͻ C
Ͼ C
Ͽ C
С C
Ҁ C
Ҫ C
Ć C
Ĉ C
Č C
Ċ C
Ç C
Ȼ C
δ d
д d
ď d
đ d
ð d
ƌ d
Ƌ d
ȡ d
Д D
Ď D
Đ D
Ð D
Ɖ D
Ɗ D
е e
ѐ e
ё e
ҽ e
ҿ e
ӗ e
ә e
ӛ e
é e
è e
ĕ e
ê e
ě e
ë e
ė e
ȩ e
ę e
ē e
ȅ e
ȇ e
ɇ e
ǝ e
Ə e
Ҽ e
Ҿ e
Ә e
Ӛ e
έ E
ε E
ϵ E
϶ E
є E
Έ E
Ε E
Ξ E
ξ E
Ѐ E
Ё E
Є E
Е E
Ӗ E
€ E
É E
È E
Ĕ E
Ê E
Ě E
Ë E
Ė E
Ȩ E
Ę E
Ē E
Ȅ E
Ȇ E
Ɇ E
Ǝ E
Ɛ E
ϝ f
ƒ f
ƒ f
Ϝ F
Ƒ F
ǵ g
ğ g
ĝ g
ǧ g
ġ g
ģ g
ǥ g
Ǵ G
Ğ G
Ĝ G
Ǧ G
Ġ G
Ģ G
Ǥ G
Ɠ G
Ђ h
Ћ h
ђ h
ћ h
ҕ h
ң h
ҥ h
һ h
Һ h
ĥ h
ȟ h
ħ h
ӈ H
ӊ H
Ή H
Η H
Н H
Ң H
Ҥ H
н H
Ӈ H
Ӊ H
Ĥ H
Ȟ H
Ħ H
Ƕ H
ΐ i
ί i
ϊ i
і i
ї i
í i
ì i
ĭ i
î i
ǐ i
ï i
ĩ i
į i
ī i
ȉ i
ȋ i
ı i
Ί I
Ι I
Ϊ I
І I
Ї I
Ӏ I
ӏ I
Í I
Ì I
Ĭ I
Î I
Ǐ I
Ï I
Ĩ I
İ I
Į I
Ī I
Ȉ I
Ȋ I
Ɨ I
ϳ j
ј j
ɉ j
Ј J
ĵ J
Ĵ J
ǰ J
ȷ J
Ɉ J
κ k
к k
ќ k
қ k
ҝ k
ҟ k
ҡ k
ӄ k
ǩ k
ķ k
ƙ k
Κ K
Ϗ K
Ќ K
К K
Қ K
Ҝ K
Ҟ K
Ҡ K
Ӄ K
Ǩ K
Ķ K
Ƙ K
ĸ K
ι l
л l
ӆ l
Ɩ l
ĺ l
ľ l
ļ l
ł l
ŀ l
ƚ l
£ L
Л L
Ӆ L
Ĺ L
Ľ L
Ļ L
Ł L
Ŀ L
Ƚ L
м m
ӎ m
Μ M
Ϻ M
ϻ M
М M
Ӎ M
ή n
η n
π n
ń n
ǹ n
ň n
ñ n
ņ n
ƞ n
Ƞ n
ŋ n
ŉ n
Ͷ N
Ν N
Π N
Ѝ N
И N
Й N
П N
Ҋ N
Ӣ N
Ӥ N
Ń N
Ǹ N
Ň N
Ñ N
Ņ N
Ɲ N
Ŋ N
ο o
ό o
ϙ o
о o
о҃ o
о҄ o
о҅ o
о҆ o
о҇ o
о҈ o
о҉ o
ѳ o
ӧ o
ө o
ӫ o
º o
ó o
ò o
ŏ o
ô o
ǒ o
ö o
ȫ o
ő o
õ o
ȭ o
ȯ o
ȱ o
ø o
ǿ o
ǫ o
ǭ o
ō o
ȍ o
ȏ o
ơ o
Ό O
Θ O
Ο O
θ O
О O
Ѳ O
Ӧ O
Ө O
Ӫ O
Ó O
Ò O
Ŏ O
Ô O
Ǒ O
Ö O
Ȫ O
Ő O
Õ O
Ȭ O
Ȯ O
Ȱ O
Ø O
Ǿ O
Ǫ O
Ǭ O
Ō O
Ȍ O
Ȏ O
Ơ O
Ɵ O
ρ p
Ϸ p
ϸ p
п p
р p
ҏ p
ƥ p
ƿ p
Ρ P
Р P
Ҏ P
Ƥ P
Ƿ P
ɋ q
Ɋ Q
г r
ѓ r
ŕ r
ř r
ŗ r
ȑ r
ȓ r
ɍ r
Я R
я R
Ŕ R
Ř R
Ŗ R
Ȑ R
Ȓ R
Ʀ R
Ɍ R
ѕ s
ś s
ŝ s
š s
ş s
ș s
ȿ s
ƨ s
š s
Ѕ S
Ś S
Ŝ S
Š S
Š S
Ş S
Ș S
Ƨ S
τ t
т t
ҭ t
ť t
ţ t
ț t
ŧ t
ƫ t
Τ T
Т T
Ҭ T
Ť T
Ţ T
Ț T
Ŧ T
Ⱦ T
Ƭ T
µ u
ΰ u
μ u
υ u
ϋ u
ύ u
ú u
ù u
ŭ u
û u
ǔ u
ů u
ü u
ǘ u
ǜ u
ǚ u
ǖ u
ű u
ũ u
ų u
ū u
ȕ u
ȗ u
ư u
Ú U
Ù U
Ŭ U
Û U
Ǔ U
Ů U
Ü U
Ǘ U
Ǜ U
Ǚ U
Ǖ U
Ű U
Ũ U
Ų U
Ū U
Ȕ U
Ȗ U
Ư U
Ʉ U
ν v
ѵ v
ѷ v
Ѵ V
Ѷ V
ω w
ώ w
ш w
щ w
ŵ w
Ш W
Щ W
Ɯ W
Ŵ W
× x
χ x
ϫ x
х x
ҳ x
ӽ x
ӿ x
Χ X
Ϫ X
Х X
Ҳ X
Ӽ X
Ӿ X
γ y
Ў y
У y
у y
ў y
ү y
ұ y
ӯ y
ӱ y
ӳ y
ý y
ŷ y
ÿ y
ȳ y
ɏ y
ƴ y
¥ Y
Ύ Y
Υ Y
Ϋ Y
Ү Y
Ұ Y
Ӯ Y
Ӱ Y
Ӳ Y
Ý Y
Ŷ Y
Ÿ Y
Ÿ Y
Ȳ Y
Ɏ Y
Ƴ Y
ź z
ž z
ž z
ż z
ƶ z
ȥ z
ɀ z
Ζ Z
Ź Z
Ž Z
Ž Z
Ż Z
Ƶ Z
Ȥ Z'

DIR=${1%/*}
FILE=${1##*/}
ASCII="${FILE}"

while read FROM TO
do
  ASCII=$( echo "${ASCII}" | sed "s|${FROM}|${TO}|g" )
done << __EOF
  echo "${LIST}"
__EOF

ASCII=$( echo ${ASCII} | tr -c -d '0-9a-zA-Z +.()[]{}=@#-_' )

if [ "${DIR}/${FILE}" != "${DIR}/${ASCII}" ]
then
  mv -i -v "${DIR}/${FILE}" "${DIR}/${ASCII}"
fi
